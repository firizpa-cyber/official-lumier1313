# Фильтрация недоступных фильмов

## Проблема
Некоторые фильмы в базе данных имеют недоступные источники видео (возвращают 404 ошибку). В частности:
- Фильмы в папке `/000new/` на сервере ant-tv.ddns.net
- Некоторые старые фильмы с устаревшими путями

Это приводило к тому, что пользователи видели карточки фильмов, но при попытке воспроизведения получали ошибку.

## Решение

### 1. Модуль фильтрации (`src/lib/movie-filter.ts`)
Создан модуль, который:
- Определяет известные нерабочие пути и ID фильмов
- Фильтрует массивы фильмов, удаляя недоступные
- Предоставляет статистику о количестве отфильтрованных фильмов

### 2. Автоматическая фильтрация
Все экспорты фильмов в `src/data/movies.ts` теперь автоматически фильтруются:
- `allMovies` - полный список доступных фильмов
- `popularMovies` - популярные фильмы
- `heroSlides` - слайды для главного баннера
- `freeMovies` - бесплатные фильмы
- `kidsMovies`, `kids0Plus`, `kids6Plus`, `kids12Plus` - детские фильмы

### 3. Уведомление для администратора
Компонент `FilteredMoviesNotice` показывает информационное уведомление о количестве скрытых фильмов.

### 4. Панель ошибок в плеере
Если пользователь все же попадет на недоступное видео (например, по прямой ссылке):
- Плеер показывает понятную ошибку вместо бесконечной загрузки
- Предлагается кнопка "Повторить попытку"
- Четкое сообщение о причине ошибки (404, сетевая ошибка и т.д.)

## Текущая статистика
- **Всего фильмов**: 109
- **Доступных**: 102 (93.6%)
- **Отфильтрованных**: 7

### Отфильтрованные фильмы:
1. ID 261: "Бабули" (2025) - `/000new/babuli/`
2. ID 259: "Белоснежка" (2025) - `/000new/belosnejka/`
3. ID 258: "Артек. Сквозь столетия" (2025) - `/000new/artek.skvoz.stoletia/`
4. ID 257: "Аббатство Даунтон 3" (2025) - `/000new/abbadstvo.daunton/`
5. ID 256: "Без правил" (2025) - `/000new/Bez.pravil/`
6. ID 210: "Аватар" (2009)
7. ID 190: "Острые козырьки" (2013)

## Проверка фильтрации
Используйте утилиту для проверки текущего состояния:

```bash
npx tsx src/lib/check-filtered-movies.ts
```

## Обновление списка нерабочих фильмов
Чтобы добавить или удалить фильмы из черного списка, отредактируйте:
```typescript
// src/lib/movie-filter.ts

const BROKEN_PATHS = [
  '/000new/babuli/',
  // ... добавьте нерабочие пути
];

const BROKEN_MOVIE_IDS = new Set([
  '261', // Бабули
  // ... добавьте ID нерабочих фильмов
]);
```

## Автоматическое восстановление
Когда источники видео станут доступны:
1. Удалите соответствующие записи из `BROKEN_PATHS` или `BROKEN_MOVIE_IDS`
2. Фильмы автоматически появятся в каталоге при следующей загрузке

## Преимущества решения
✅ Пользователи видят только работающие фильмы
✅ Нет бесконечной загрузки или черного экрана
✅ Понятные сообщения об ошибках
✅ Легко обновляемый список исключений
✅ Автоматическая статистика
✅ Информирование администратора
